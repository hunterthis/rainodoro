<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rainodoro</title>
  <link rel="stylesheet" href="style.css?v=20260227o">
</head>
<body>
  <main class="app">
    <header>
      <h1 id="mainTitle">Rainodoro</h1>
      <div class="header-buttons">
        <button id="infoToggle" class="header-btn" title="About Rainodoro">â„¹</button>
        <button id="fullscreenToggle" class="header-btn" title="Fullscreen Bucket Mode">â›¶</button>
        <button id="focusToggle" class="focus-toggle header-btn" title="Ultra Focus Mode">Ultra Focus Mode</button>
      </div>
    </header>

    <section class="controls">
      <div class="modes">
        <button data-mode="pomodoro" class="mode active">Pomodoro</button>
        <button data-mode="short" class="mode">Break</button>
      </div>
    </section>

    <aside class="sidebar">
      <div id="sidebarTasks" class="section">
        <div class="section-kicker">Task Sheet</div>
        <div class="task-sheet-row">
          <select id="taskSheetSelect" aria-label="Task Sheet"></select>
          <button id="addTaskSheetBtn" type="button" class="count-btn" title="Create sheet">ï¼‹</button>
          <button id="renameTaskSheetBtn" type="button" class="count-btn" title="Rename sheet">âœŽ</button>
          <button id="deleteTaskSheetBtn" type="button" class="count-btn" title="Delete sheet">ðŸ—‘</button>
        </div>
        <div class="section-header">
          <h3>Tasks</h3>
          <div class="section-controls">
            <span class="count-label">Pomos</span>
            <button id="pomoDec" class="count-btn">âˆ’</button>
            <span id="pomoCount" class="count-display">0</span>
            <button id="pomoInc" class="count-btn">+</button>
          </div>
        </div>
        <form id="taskForm" style="display:flex;gap:6px;margin-bottom:10px">
          <input id="taskTitle" placeholder="New task title" required style="flex:1" />
          <button type="submit" class="count-btn" title="Add task">ï¼‹</button>
          <button id="editModeBtn" type="button" class="count-btn" title="Edit tasks">âœŽ</button>
        </form>
        <div id="taskTitleWarning" class="input-warning" style="display:none">Task title is over 50 characters. Please shorten it.</div>
        <div id="taskList" class="task-grid"></div>
      </div>

      <div id="sidebarShortBreaks" class="section">
        <div class="section-header">
          <h3>Break Items</h3>
          <div class="section-controls">
            <button id="shortDec" class="count-btn">âˆ’</button>
            <span id="shortCount" class="count-display">0</span>
            <button id="shortInc" class="count-btn">+</button>
          </div>
        </div>
        <form id="shortBreakForm" style="display:flex;gap:6px;margin-bottom:10px"><input id="shortBreakInput" placeholder="Add break item" style="flex:1" /><button type="submit" class="count-btn" title="Add break item">ï¼‹</button><button id="editModeBtnBreak" type="button" class="count-btn" title="Edit break items">âœŽ</button></form>
        <div id="shortBreakList" class="task-grid"></div>
      </div>
    </aside>

    <section class="visual">
      <div class="bucket-wrap">
        <div class="bucket">
          <div class="water" id="water"></div>
          <div class="rain-overlay" id="rainOverlay"></div>
        </div>
      </div>

      <div class="sidepanel">
        <div class="timer-compact">
          <div id="time">25:00</div>
          <div class="buttons">
            <button id="start">Start</button>
            <button id="pause" disabled>Pause</button>
            <button id="reset">Reset</button>
            <button id="pourBtn" disabled title="Fill the bucket to pour">Pour</button>
          </div>
          <button id="timerToggle" class="timer-toggle-btn" title="Hide the Timer">Hide the Timer</button>
          <button id="finishTaskBtn" class="timer-toggle-btn" title="Finish Pomodoro">Finished Pomo</button>
          <div id="breakPlusTenRow" class="break-plus-ten-row">
            <button id="breakPlusTenBtn" class="timer-toggle-btn">+10 Min Break</button>
          </div>
        </div>
        <p class="status" id="status">Ready</p>
        <div class="active-task" id="activeTaskDisplay">No task selected</div>
        <div class="pour-stats">
          <div class="stat">Pomos: <span id="pomoPours">0</span> <button id="resetPomoPours" class="reset-pour-btn" title="Reset">â†»</button></div>
          <div class="stat">Break Pomos: <span id="breakPours">0</span> <button id="resetBreakPours" class="reset-pour-btn" title="Reset">â†»</button></div>
        </div>
        <div class="audio-controls-panel">
          <div class="settings">
            <label>Volume: <input id="volumeControl" type="range" min="0" max="1" step="0.01" value="0.18"></label>
            <button id="muteBtn" class="mute-btn" title="Toggle Mute">ðŸ”Š Mute</button>
          </div>
        </div>
      </div>
    </section>

    <section id="infoSection" class="info-section" style="display:none">
      <div class="info-content">
        <h2>About Rainodoro</h2>
        <p><strong>The Pomodoro Technique</strong> is a time management method that uses timed intervals (typically 25 minutes) for focused work, followed by short breaks. It helps maintain productivity while preventing burnout.</p>
        <p><strong>Rainodoro</strong> is a low-sensory approach to Pomodoros. Instead of loud alarms and anxiety-inducing countdowns, we use the gentle visual of rain filling a bucket. This creates a calming, meditative experience where time passes naturallyâ€”allowing you to stay focused without the stress of watching the clock.</p>
      </div>
    </section>

    <footer>
      <section id="pomoStatsDock" class="pomo-stats-dock">
        <button id="pomoStatsToggle" class="timer-toggle-btn" style="margin-top:8px;">Your Pomo Stats</button>
        <div id="pomoStatsPanel" style="display:none;margin-top:8px;">
          <div class="completed-summary">Your Pomo Stats</div>
          <div class="stats-subnav" style="display:flex;gap:8px;margin-top:8px">
            <button id="statsTasksBtn" class="timer-toggle-btn">Tasks</button>
            <button id="statsPomosBtn" class="timer-toggle-btn">Pomos</button>
            <button id="statsTimeBtn" class="timer-toggle-btn">Time</button>
            <button id="printSessionBtn" class="timer-toggle-btn" title="Print Session Summary">ðŸ“‹ Summary</button>
          </div>

          <div id="tasksSection" class="panel-small" style="margin-top:8px;display:none">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div style="font-weight:600">Tasks (<span id="tasksCount">0</span>)</div>
              <button id="resetTasksBtn" class="reset-stat-btn" title="Reset task progress">Reset</button>
            </div>
            <ul id="tasksPanelList" class="completed-list" style="margin-top:8px"></ul>
          </div>

          <div id="pomosSection" class="panel-small" style="margin-top:8px;display:none">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div style="font-weight:600">Pomos</div>
              <button id="resetPomosBtn" class="reset-stat-btn" title="Clear completed pomos">Reset</button>
            </div>
            <div class="completed-summary" style="margin-top:6px">Total Pomodoro Time: <span id="totalPomoTime">0m</span></div>
            <ul id="completedList" class="completed-list" style="margin-top:8px"></ul>
          </div>

          <div id="timeSection" class="panel-small" style="margin-top:8px;display:none">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div style="font-weight:600">Time Breakdown</div>
              <button id="resetTimeBtn" class="reset-stat-btn" title="Clear completed pomos (resets time)">Reset</button>
            </div>
            <div id="timeBreakdown" style="font-size:12px;color:var(--muted);margin-top:6px"></div>
          </div>
        </div>
      </section>
      <span id="buildVersion" class="build-version" aria-label="Build version"></span>
    </footer>

    <div id="sessionModal" class="session-modal" style="display:none">
      <div class="session-modal-content">
        <div class="session-modal-header">
          <h2>Pomodoro Session Summary</h2>
          <button class="modal-close" id="closeSessionModal">âœ•</button>
        </div>
        <div class="session-modal-body">
          <div id="sessionSummaryContent" style="color:#e6eef6;font-size:13px;line-height:1.8"></div>
        </div>
        <div class="session-modal-footer">
          <button id="printSessionPdfBtn" class="modal-btn primary-btn">ðŸ–¨ Print / PDF</button>
          <button id="clearSessionBtn" class="modal-btn secondary-btn">Clear History</button>
          <button id="closeSessionModalBtn" class="modal-btn">Close</button>
        </div>
      </div>
    </div>

    <!-- Fullscreen Immersive Mode -->
    <div id="immersive-host" class="immersive-hidden">
      <canvas id="immersive-canvas"></canvas>
      <div id="immersive-timer-overlay" class="immersive-timer-display"></div>
      <button id="immersive-exit-btn" class="immersive-exit-btn" title="Exit fullscreen">âœ•</button>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js"></script>
  <script src="graphics-controller.js?v=20260220p"></script>
  <script src="app.js?v=20260227o"></script>
</body>
</html>
