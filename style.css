:root{
  --bg:#0b1020;
  --card:#0f1724;
  --accent:#4ea8de;
  --muted:#9aa4b2;
}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui,Arial;background:linear-gradient(180deg,#071021 0%,#0b1320 100%);color:#e6eef6;display:flex;min-height:100vh;align-items:flex-start;justify-content:center;padding:clamp(8px,1.8vw,20px)}
.app{width:100%;max-width:1200px;padding:clamp(14px,2.2vw,28px);background:rgba(255,255,255,0.02);border-radius:12px;box-shadow:0 10px 30px rgba(2,6,23,0.6);display:grid;grid-template-columns:minmax(0,1fr) minmax(260px, 350px);grid-template-rows:auto auto 1fr;grid-template-areas:"header header" "controls controls" "visual sidebar";gap:clamp(12px,2vw,24px);align-items:start;min-height:auto;position:relative;z-index:10}
.app.focus-mode{width:100%;max-width:100%;padding:0;background:transparent;box-shadow:none;display:flex;flex-direction:column;align-items:center;justify-content:center}
header{grid-area:header;display:flex;justify-content:space-between;align-items:center;position:relative;width:100%}
.app.focus-mode header{justify-content:center}
h1{margin:0;font-size:28px}
.app.focus-mode h1{display:none}
.header-buttons{display:flex;gap:8px;align-items:center;flex-wrap:wrap;justify-content:flex-end}
.header-btn{background:transparent;border:1px solid rgba(255,255,255,0.1);color:#e6eef6;padding:8px 12px;border-radius:8px;cursor:pointer;font-size:12px}
.focus-toggle{background:transparent;border:1px solid rgba(255,255,255,0.1)}
.app.focus-mode .header-buttons{position:fixed;top:20px;right:20px;gap:12px;flex-direction:row;display:flex;z-index:100003}
.app.focus-mode .header-btn{background:rgba(255,255,255,0.05);padding:10px 14px}
.app.focus-mode #infoToggle,
.app.focus-mode #fullscreenToggle{display:none !important}
.app.focus-mode #focusToggle{display:inline-flex;align-items:center;justify-content:center;min-width:56px;font-weight:600;letter-spacing:0.6px;background:rgba(11,16,32,0.82);border:1px solid rgba(78,168,222,0.45)}
.timer-toggle-btn{margin-top:8px;padding:6px 8px;border-radius:6px;border:none;background:#17324b;color:#e6f0fb;cursor:pointer;width:100%;font-size:12px}
.timer-main-btn{margin-top:8px;padding:8px 10px;border-radius:8px;border:none;background:#17324b;color:#e6f0fb;cursor:pointer;width:100%;font-size:14px}
.timer-main-btn:disabled{background:#0a1020;color:#4a5a6a;cursor:not-allowed;opacity:0.5}
.info-section{margin-top:16px;padding:12px;background:rgba(78,168,222,0.05);border:1px solid rgba(78,168,222,0.1);border-radius:8px;max-width:600px;margin-left:auto;margin-right:auto}
.info-content{color:#e6eef6;font-size:13px;line-height:1.6}
.info-content h2{margin:0 0 10px 0;font-size:16px;color:var(--accent)}
.info-content p{margin:0 0 8px 0}
.info-content p:last-child{margin-bottom:0}
.tagline{margin:0;color:var(--muted)}
.controls{grid-area:controls;display:flex;gap:20px;align-items:center;justify-content:center;margin-top:0;width:100%}
.modes{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px;width:min(100%,420px);flex:0 1 420px}
.mode{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:8px 12px;border-radius:8px;cursor:pointer;min-width:0;height:36px;display:flex;align-items:center;justify-content:center;font-weight:500;line-height:1;box-sizing:border-box}
.mode.active{background:var(--accent);color:#041024;border:1px solid rgba(255,255,255,0.06)}
.timer{flex:1;text-align:center}
#time{font-size:48px;font-weight:600}
.buttons{display:flex;gap:8px;justify-content:center;margin-top:8px}
.buttons button{padding:8px 12px;border-radius:8px;border:none;background:#17324b;color:#e6f0fb;cursor:pointer}
.settings{display:inline-flex;flex-direction:row;gap:8px;color:var(--muted);align-items:center;flex-wrap:nowrap;white-space:nowrap}
.settings label{display:inline-flex;align-items:center;gap:8px;white-space:nowrap;margin:0}
.settings input[type="range"]{width:120px}
.mute-btn{padding:6px 12px;border-radius:20px;border:none;background:#17324b;color:#e6f0fb;cursor:pointer;font-size:12px;transition:background 0.2s;margin-top:0;align-self:center}
.mute-btn:hover{background:#1f3d52}
.audio-controls-panel{width:100%;display:flex;justify-content:flex-end;margin-top:12px}
.visual{grid-area:visual;margin-top:0;display:flex;gap:clamp(14px,3vw,40px);align-items:start;justify-content:center;width:100%;flex-wrap:wrap}
.sidepanel{display:flex;flex-direction:column;align-items:center;gap:8px;min-width:0;width:100%}
 .timer-compact{background:transparent;padding:10px;border-radius:8px;min-width:140px;text-align:center;width:min(100%,260px);margin:0 auto}
.timer-compact #time{font-size:28px;font-weight:600}
.timer-compact .buttons{display:flex;flex-direction:column;gap:8px;justify-content:flex-start;margin-top:8px;align-items:stretch}
.timer-compact .buttons button{padding:8px 10px;border-radius:8px;border:none;background:#17324b;color:#e6f0fb;cursor:pointer;width:100%}
.timer-compact .buttons button:disabled{background:#0a1020;color:#4a5a6a;cursor:not-allowed;opacity:0.5}
.timer-compact{min-width:120px}
.break-plus-ten-row{max-height:0;opacity:0;overflow:hidden;transform:translateY(-4px);transition:max-height .22s ease,opacity .2s ease,transform .22s ease;margin-top:0}
.break-plus-ten-row.visible{max-height:56px;opacity:1;transform:translateY(0);margin-top:6px}
.break-plus-ten-row .timer-toggle-btn{margin-top:0}
.settings label{display:flex;align-items:center;gap:8px}
.settings input[type="range"]{width:120px}
.pour-btn{display:inline-block}

.app.focus-mode .visual{margin:0;flex-direction:column;justify-content:flex-start;align-items:center;gap:24px;width:100%;padding-top:8vh}
.app.focus-mode .sidepanel{display:flex;flex-direction:column;align-items:center}
.app.focus-mode .timer-compact{min-width:auto}
.app.focus-mode .active-task{font-size:24px;color:#e6eef6;font-weight:600;margin-top:24px}
.app.focus-mode .status{margin:0;font-size:14px}
.app.focus-mode .pour-stats{display:none}
.app.focus-mode .section form,.app.focus-mode .controls,.app.focus-mode .sidebar{display:none}
.app.focus-mode #pomoStatsToggle,
.app.focus-mode #pomoStatsPanel{width:min(100%,260px)}
.app.focus-mode .stats-subnav{display:flex !important;flex-direction:column;gap:8px;margin-top:8px !important;width:100%}
.app.focus-mode .stats-subnav .timer-toggle-btn{width:100%;margin-top:0}
.app.focus-mode .stats-subnav .timer-main-btn{width:100%;margin-top:0}
.app.focus-mode .audio-controls-panel{justify-content:center}
.app.focus-mode .audio-controls-panel .settings{justify-content:center;width:min(100%,260px)}
.sidebar{grid-area:sidebar;position:relative;width:100%;margin:0;padding:0 0 0 24px;border-left:1px solid rgba(78,168,222,0.1);background:transparent;display:flex;flex-direction:column;gap:16px;max-height:none;overflow:visible}
.section{margin-bottom:12px;flex-shrink:0}
.section-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.section-header h3{margin:0;font-size:14px;text-transform:uppercase;letter-spacing:0.5px;color:#e6eef6}
.section-controls{display:flex;align-items:center;gap:6px}
.section-kicker{font-size:12px;color:var(--muted);text-transform:uppercase;letter-spacing:0.6px;margin-bottom:6px}
.count-label{font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:0.5px;margin-right:2px}
.task-sheet-row{display:flex;align-items:center;gap:6px;margin-bottom:10px}
.task-sheet-row select{flex:1;min-width:0;padding:6px;border-radius:6px;border:1px solid rgba(78,168,222,0.35);background:#0f1724;color:#e6eef6;appearance:none}
.task-sheet-row select:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 2px rgba(78,168,222,0.2)}
.task-sheet-row select option{background:#0f1724;color:#e6eef6}
.task-sheet-row .count-btn{padding:5px 8px}
.count-btn{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);padding:4px 8px;border-radius:6px;cursor:pointer;font-size:12px}
.count-display{font-size:12px;color:var(--muted);min-width:20px;text-align:center}
.task-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:10px;margin-bottom:12px;max-height:none;overflow-y:visible;padding:0}
.task-card{padding:12px;border-radius:8px;border:2px solid rgba(78,168,222,0.2);background:rgba(78,168,222,0.05);cursor:pointer;transition:all 0.2s;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;text-align:center;min-height:90px;max-height:120px;height:auto;user-select:none;position:relative;overflow:hidden}
.task-card:hover{border-color:rgba(78,168,222,0.4);background:rgba(78,168,222,0.1)}
.task-card.selected{border-color:var(--accent);background:rgba(78,168,222,0.2);box-shadow:0 0 10px rgba(78,168,222,0.3)}
.task-card-title{font-size:12px;font-weight:500;color:#e6eef6;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:100%;margin-bottom:4px;overflow-wrap:anywhere;word-break:break-word}
.task-card.selected{max-height:none}
.task-card.selected .task-card-title{white-space:normal;overflow:visible;text-overflow:clip}
.task-card-stat{font-size:10px;color:var(--muted)}
.task-card-pomos{font-size:10px;color:#cfe6ff;margin-top:2px}
.input-warning{font-size:11px;color:#ff8b8b;margin-top:-4px;margin-bottom:8px}
.card-corner-btn{position:absolute;padding:2px 5px;border-radius:4px;border:1px solid rgba(255,255,255,0.18);background:#17324b;color:#e6f0fb;cursor:pointer;font-size:9px;line-height:1;z-index:2}
.corner-edit{top:6px;left:6px}
.corner-delete{top:6px;right:6px}
.corner-move{bottom:6px;right:6px}
body.immersive-active .card-corner-btn{display:none !important}
 .target-controls{display:inline-flex;align-items:center;gap:8px}
 .target-controls button{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);padding:4px 8px;border-radius:6px;cursor:pointer}
 .target-controls span{font-size:12px;color:var(--muted)}
.breaks{margin-top:8px}
.break-section{margin-bottom:10px}
.break-list{list-style:none;padding:0;margin:0 0 12px 0;max-height:300px;overflow-y:auto}
 .break-list li{display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:6px;border:1px solid rgba(78,168,222,0.06);background:transparent;margin-bottom:6px}
 .break-list li.draggable-item{cursor:grab}
 .break-list li.draggable-item:active{cursor:grabbing}
 .break-list li.dragging{opacity:0.5;border-color:rgba(78,168,222,0.4);background:rgba(78,168,222,0.06)}
.reset-pour-btn{padding:2px 4px;border-radius:3px;border:none;background:var(--accent);color:#041024;cursor:pointer;font-size:10px}
.section form{display:flex;gap:6px;margin-bottom:10px}
.section input{flex:1;padding:6px;border-radius:6px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
.section button[type="submit"]{padding:6px 8px;border-radius:6px;border:none;background:var(--accent);color:#041024;cursor:pointer}
#taskForm .count-btn,
#shortBreakForm .count-btn{padding:5px 8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--muted);border-radius:6px;cursor:pointer;min-width:30px}
.sidebar > .active-task{margin-bottom:12px;padding:10px;border-radius:6px;border:1px solid rgba(78,168,222,0.06);background:transparent;color:#e6eef6;font-size:24px;font-weight:600;max-width:100%;overflow-wrap:anywhere;word-break:break-word;line-height:1.25}
.sidepanel .active-task{margin-top:12px;color:#e6eef6;font-size:24px;font-weight:600;max-width:100%;overflow-wrap:anywhere;word-break:break-word;line-height:1.25;text-align:center}
.sidepanel .status{text-align:center;margin-left:0}
.pour-stats{margin-top:12px;display:flex;gap:16px;font-size:12px;color:var(--muted)}
.stat{display:flex;gap:6px}
.bucket-wrap{position:relative;width:240px;height:320px;margin:0 12px}
.bucket{position:absolute;left:0;right:0;bottom:0;margin:auto;width:180px;height:240px;border:6px solid #cfe8ff22;border-bottom-width:32px;border-radius:8px 8px 28px 28px;overflow:hidden;background:linear-gradient(180deg,#0b1b2a, #07121a);position:relative}
.bucket::after{content:'';position:absolute;right:-40px;top:40px;width:40px;height:100px;border:6px solid #cfe8ff22;border-left:none;border-radius:0 20px 20px 0;background:transparent}
.water{position:absolute;left:0;right:0;bottom:0;height:0;background:linear-gradient(180deg,#7ad2ff 0%,#5dbdff 40%,#2ea3ff 100%);transition:height 0.1s ease-out;overflow:hidden}
.water::before{content:'';position:absolute;top:-2px;left:0;right:0;height:15px;background:linear-gradient(180deg,rgba(255,255,255,0.8) 0%,rgba(255,255,255,0.3) 50%,transparent 100%);animation:wave 2.2s ease-in-out infinite;filter:blur(0.5px)}
.water::after{content:'';position:absolute;top:0;left:0;right:0;height:100%;background:radial-gradient(circle at 20% 30%,rgba(255,255,255,0.1) 0%,transparent 50%),radial-gradient(circle at 80% 70%,rgba(0,0,0,0.05) 0%,transparent 50%);pointer-events:none}
.rain-overlay{position:absolute;inset:0;pointer-events:none}
.ripple{position:absolute;border:2px solid rgba(255,255,255,0.8);border-radius:50%;pointer-events:none;box-shadow:0 0 10px rgba(255,255,255,0.6), inset 0 0 6px rgba(255,255,255,0.4)}
.bubble{position:absolute;background:radial-gradient(circle at 35% 35%,rgba(255,255,255,1),rgba(150,200,255,0.3));border-radius:50%;pointer-events:none;border:1.5px solid rgba(255,255,255,0.6);box-shadow:0 0 8px rgba(255,255,255,0.5), inset -1px -1px 3px rgba(0,0,0,0.2)}
.status{color:var(--muted);margin-left:8px}
footer{margin-top:18px;color:var(--muted);font-size:12px}
.build-version{display:inline-block;opacity:0.8;letter-spacing:0.3px}
.toast-alert{position:fixed;left:50%;bottom:18px;transform:translateX(-50%) translateY(10px);padding:10px 12px;border-radius:8px;background:rgba(15,23,36,0.96);border:1px solid rgba(78,168,222,0.25);color:#e6eef6;font-size:12px;opacity:0;pointer-events:none;transition:opacity 0.2s ease, transform 0.2s ease;z-index:9999;max-width:min(92vw,420px);text-align:center}
.toast-alert.show{opacity:1;transform:translateX(-50%) translateY(0)}

.session-modal{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;z-index:10000;backdrop-filter:blur(4px)}
.session-modal-content{background:var(--card);border-radius:12px;box-shadow:0 20px 60px rgba(2,6,23,0.8);max-width:600px;width:90%;max-height:80vh;display:flex;flex-direction:column;border:1px solid rgba(78,168,222,0.2)}
.session-modal-header{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid rgba(78,168,222,0.1)}
.session-modal-header h2{margin:0;font-size:18px;color:#e6eef6}
.modal-close{background:transparent;border:none;color:#e6eef6;font-size:24px;cursor:pointer;padding:0;width:28px;height:28px;display:flex;align-items:center;justify-content:center}
.session-modal-body{padding:20px;overflow-y:auto;flex:1;color:#e6eef6}
.session-modal-footer{display:flex;gap:8px;padding:16px 20px;border-top:1px solid rgba(78,168,222,0.1);justify-content:flex-end}
.modal-btn{padding:8px 14px;border-radius:6px;border:none;cursor:pointer;font-size:12px;font-weight:500}
.modal-btn.primary-btn{background:var(--accent);color:#041024}
.modal-btn.secondary-btn{background:#e74c3c;color:#fff}
.modal-btn{background:rgba(78,168,222,0.15);color:#e6eef6;border:1px solid rgba(78,168,222,0.3)}

@media print {
  body, .app, header { background:white; color:black; }
  .session-modal { display:none !important; }
  .session-modal-content { background:white; border:none; box-shadow:none; }
  .session-modal-header { border-bottom:1px solid #ccc; }
  .session-modal-footer { display:none; }
}



/* water animations */
@keyframes wave{0%,100%{transform:translateY(0px) scaleY(1)}33%{transform:translateY(-7.5px) scaleY(1.15)}66%{transform:translateY(2.5px) scaleY(0.95)}}
@keyframes ripple{0%{transform:scale(0);opacity:1}100%{transform:scale(1);opacity:0}}
@keyframes bubble-rise{0%{transform:translateY(0px) translateX(0px);opacity:0.7}100%{transform:translateY(-35px) translateX(3px);opacity:0}}

/* small raindrops animation for overlay */
@keyframes drop{0%{transform:translateY(-10px);opacity:0}50%{opacity:1}100%{transform:translateY(220px);opacity:0}}
.raindrop{position:absolute;width:2px;height:14px;background:linear-gradient(180deg,rgba(255,255,255,0.85),rgba(255,255,255,0.2));border-radius:2px;display:none}

/* responsive */
@media(max-width:768px){
  .app{display:flex;flex-direction:column;padding:16px;gap:16px;align-items:stretch}
  header{width:100%}
  .header-buttons{justify-content:center}
  .controls{flex-direction:column;align-items:stretch;gap:12px}
  .modes{width:100%;flex:1 1 auto}
  .settings{display:inline-flex;flex-direction:row;flex-wrap:nowrap;align-items:center}
  .visual{flex-direction:column;align-items:center;gap:20px}
  .sidebar{width:100%;max-height:none;padding:20px 0;border-top:1px solid rgba(78,168,222,0.1);border-left:none;padding-left:0;margin:0}
  .bucket-wrap{width:200px;height:260px}
  .bucket{width:160px;height:210px}
}

@media(max-width:520px){
  .app{padding:12px;gap:12px}
  .controls{gap:8px;align-items:stretch}
  .controls .modes{align-self:center}
  .audio-controls-panel{justify-content:flex-end}
  .visual{gap:16px}
  .task-grid{grid-template-columns:repeat(auto-fit,minmax(120px,1fr))}
  .bucket-wrap{width:160px;height:220px}
  .bucket{width:130px;height:190px}
  .timer-compact #time{font-size:28px}
  .sidebar{padding:16px 0}
}

@media (max-width:1100px), (orientation:portrait){
  .app{
    grid-template-columns:1fr;
    grid-template-rows:auto auto auto auto;
    grid-template-areas:
      "header"
      "controls"
      "visual"
      "sidebar";
    align-items:stretch;
  }
  .controls{justify-content:center}
  .visual{flex-direction:column;align-items:center;justify-content:flex-start;gap:16px}
  .sidebar{
    padding:16px 0 0 0;
    border-left:none;
    border-top:1px solid rgba(78,168,222,0.1);
  }
}

/* Fullscreen Immersive Mode Styles */
#immersive-host {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #0b1020;
  z-index: 1;
  display: flex;
  align-items: center;
  justify-content: center;
}

#immersive-host.immersive-hidden {
  display: none;
  z-index: -1;
}

#immersive-canvas {
  position: absolute;
  top: 0;
  left: 0;
  display: block;
  width: 100%;
  height: 100%;
}

#immersive-timer-overlay {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 36px;
  font-weight: bold;
  color: #e6eef6;
  font-family: 'Courier New', monospace;
  text-shadow: 0 0 10px rgba(78, 168, 222, 0.5);
  pointer-events: none;
  z-index: 100001;
  letter-spacing: 2px;
}

#immersive-exit-btn {
  position: fixed;
  top: 20px;
  right: 20px;
  width: 40px;
  height: 40px;
  background: transparent;
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: #e6eef6;
  font-size: 24px;
  cursor: pointer;
  border-radius: 6px;
  z-index: 100002;
  opacity: 0;
  transition: opacity 0.3s ease;
}

#immersive-host:hover #immersive-exit-btn {
  opacity: 1;
}

#immersive-exit-btn:hover {
  background: rgba(255, 255, 255, 0.1);
}

@media(max-width:768px) {
  #immersive-timer-overlay {
    font-size: 28px;
    letter-spacing: 1px;
  }
}
